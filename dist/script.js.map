{"version":3,"sources":["../script.js"],"names":[],"mappings":"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","file":"script.js","sourcesContent":["var watchers = {};\nvar c1 = document.createElement('canvas');\nvar ctx1 = c1.getContext('2d');\nvar player = document.getElementById('player');\nvar c2 = document.getElementById('c2');\nvar ctx2 = c2.getContext('2d');\n\nvar $TL = $('#TL');\nvar $BL = $('#BL');\nvar $BR = $('#BR');\nvar $TR = $('#TR');\n\nfunction init() {\n  var scale = 0.5;\n\n  var videoFile = document.getElementById(\"uploadInput\").files[0];\n  var leftMoves = files[videoFile.name.replace('.mp4', '')].left;\n  var rightMoves = files[videoFile.name.replace('.mp4', '')].right;\n  var leftPositions = files[videoFile.name.replace('.mp4', '')].leftPosition;\n  var rightPositions = files[videoFile.name.replace('.mp4', '')].rightPosition;\n  for (var i = 0; i < 240; i++) {\n    $('#result tbody').append(`\n      <tr id=\"event-${i}\">\n        <th>#${i + 1}, ${leftMoves[i]}</th>\n        <td class=\"leftResult\"></td>\n        <th>#${i + 1}, ${rightMoves[i]}</th>\n        <td class=\"rightResult\"></td>\n      </tr>\n    `);\n  }\n\n  player.src = URL.createObjectURL(videoFile);\n\n  player.addEventListener('canplay', function () {\n    $('#uploadInput').hide();\n    player.currentTime = 0.5; // Triggers seek\n\n    c1.width = (player.videoWidth * scale) | 0;\n    c1.height = (player.videoHeight * scale) | 0;\n    c2.width = (player.videoWidth * scale) | 0;\n    c2.height = (player.videoHeight * scale) | 0;\n  });\n\n  player.addEventListener('seeked', function () {\n    ctx2.drawImage(player, 0, 0, c2.width, c2.height);\n\n    $('#panel').show();\n  }, false);\n\n  $('#startProcess').click(() => {\n    $('#startProcess').hide();\n    $('#mask').show();\n    player.play();\n    next();\n  });\n}\n  function next() {\n    if (player.paused || player.ended) {\n      return;\n    }\n    computeFrame();\n    setTimeout(next, 5);\n  }\n\n  var r = 0;\n  var g = 0;\n  var b = 0;\n  var intensity = 0;\n  var x = 0;\n  var y = 0;\n\n  var TLM00 = 0;\n  var TLM10 = 0;\n  var TLM01 = 0;\n\n  var TRM00 = 0;\n  var TRM10 = 0;\n  var TRM01 = 0;\n\n  var BLM00 = 0;\n  var BLM10 = 0;\n  var BLM01 = 0;\n\n  var BRM00 = 0;\n  var BRM10 = 0;\n  var BRM01 = 0;\n\n  function computeFrame() {\n    ctx1.drawImage(player, 0, 0, c2.width, c2.height);\n    var frame = ctx1.getImageData(0, 0, c2.width, c2.height);\n    var l = frame.data.length / 4;\n    var width = c2.width | 0;\n    var height = c2.height | 0;\n\n    TLM00 = 0;\n    TLM10 = 0;\n    TLM01 = 0;\n\n    TRM00 = 0;\n    TRM10 = 0;\n    TRM01 = 0;\n\n    BLM00 = 0;\n    BLM10 = 0;\n    BLM01 = 0;\n\n    BRM00 = 0;\n    BRM10 = 0;\n    BRM01 = 0;\n\n    for (var i = 0; i < l; i++) {\n      r = frame.data[i * 4];\n      g = frame.data[i * 4 + 1];\n      b = frame.data[i * 4 + 2];\n      intensity = (0.2989 * r + 0.5870 * g + 0.1140 * b) | 0;\n\n      x = i % width;\n      y = (i / width) | 0;\n\n      if (x < width / 2 && y < height / 2) {\n        TLM00 += intensity;\n        TLM10 += x * intensity;\n        TLM01 += y * intensity;\n      }\n      if (x > width / 2 && y < height / 2) {\n        TRM00 += intensity;\n        TRM10 += x * intensity;\n        TRM01 += y * intensity;\n      }\n      if (x > width / 2 && y > height / 2) {\n        BRM00 += intensity;\n        BRM10 += x * intensity;\n        BRM01 += y * intensity;\n      }\n      if (x < width / 2 && y > height / 2) {\n        BLM00 += intensity;\n        BLM10 += x * intensity;\n        BLM01 += y * intensity;\n      }\n\n      frame.data[i * 4] = intensity;\n      frame.data[i * 4 + 1] = intensity;\n      frame.data[i * 4 + 2] = intensity;\n      frame.data[i * 4 + 3] = 255;\n    }\n    ctx2.putImageData(frame, 0, 0);\n    $TL.attr('cx', TLM10 / TLM00).attr('cy', TLM01 / TLM00);\n    $BL.attr('cx', BLM10 / BLM00).attr('cy', BLM01 / BLM00);\n    $BR.attr('cx', BRM10 / BRM00).attr('cy', BRM01 / BRM00);\n    $TR.attr('cx', TRM10 / TRM00).attr('cy', TRM01 / TRM00);\n  }\n  player.addEventListener('ended', function () {\n    console.log('end');\n  });\n"]}